---
layout: default
---

#**TLD**

####&nbsp;&nbsp;&nbsp;&nbsp;这里主要讨论的是文件[1]的TLD跟踪算法。TLD(Tracking-Learning-Detection)是一种针对单一目标的长时间跟踪算法(long-term tracking)。长时间跟踪问题是指：长时间的视频，我们希望对其中某个目标进行跟踪（一个人，一辆车，或者仅仅是一块运动的区域），首先在某一帧画面规定一个矩形框，框住的区域就是我们关注的目标，那么该算法做的事就是在接下来的视频中不断跟踪这个目标，无论该物体是否暂时离开画面，或者被遮挡，或者发生形变，都不会影响继续的跟踪。要实现这样的长时间跟踪，有一些需要面对的问题。其中最关键的问题是，如果跟踪的目标暂时离开画面，那么当它重新出现的时候，如何检测？还要考虑到尺度、光照变化，复杂背景，实时检测等。

####&nbsp;&nbsp;&nbsp;&nbsp;传统的跟踪方法分为模板匹配和检测跟踪方法，模板匹配就是对模板进行特征提取，并在待跟踪的图像提取特征，取匹配程度最高的那块，作为跟踪的结果。而检测跟踪是指首先在目标周围采样正负样本进行分类器的训练，并在跟踪帧在上一帧的目标位置附近用分类器进行分类，寻找正样本的最佳位置，现在检查跟踪方法已经成为了跟踪方法的主流，因其速度快效率高。

####&nbsp;&nbsp;&nbsp;&nbsp;TLD也是一种检测跟踪方法，分为三个模块：跟踪模块，检测模块，学习模块，每个模块独立运行又互相协作，如下图所示：

<div style="text-align: center">
<img src="../Images/TLD1.jpg">
</div>

1. <h4>对于跟踪模块，它假设目标在帧与帧之间的运动是连续并且可见的而且两帧之间的运动不能太剧烈，相邻两帧之间的亮度恒定，即光线不会发生大的变化，从而估计出目标在下一帧的位置（这里用到的是光流法）。并将估计到的区域提交给学习模块。</h4>
2. <h4>对于检测模块，它根据学习模块提供的训练集进行训练，对每一帧画面进行检测（这里用到了随机森林方法）扫面全图中所有可能见到的目标位置(**这也是TLD能够在跟丢之后有很好的重新检测定位的能力**)，将检测到的区域反馈给学习模块，并利用检测到的区域对跟踪模块进行重新初始化。<h4>
3. 对于学习模块，它是整个TLD系统的“大脑”，是核心部分。在得到跟踪模块以及检测模块提供的样本之后，它要对这两种样本进行一种“取舍”（这里用到的是一种PN-Learning学习方法），再把得到的结果提供给检测模块。可以说，跟踪与检测模块提供的样本是可以互相修复互相纠正的，以达到错误率最小的效果。

- ###**跟踪模块**

####&nbsp;&nbsp;&nbsp;&nbsp;TLD的跟踪模块使用的算法是基于Median Flow tracker（中值流跟踪）的，在这个基础上增加了失败检测。中值流跟踪方法利用目标框(Bounding box)来表示被跟踪的目标，并在连续的相邻视频帧之间估计目标的运动。具体的流程如下：

1. <h4>首先在上一帧的目标框中均匀采样10*10个特征点(网格均匀撒点)</h4>
2. <h4>利用金字塔LK光流法跟踪这些特征点，并预测当前帧的特征点，计算特征点的匹配，舍去跟踪不好的特征点；
3. 用剩余的特征点来预测目标框bounding box的位置和大小
4. 跟踪失败检测：如果跟踪的特征点匹配上的个数小于某个阈值，或是bounding box超出画面，则认为跟踪失败，否则跟踪有效.


- ###**检测模块**

####&nbsp;&nbsp;&nbsp;&nbsp;检测器假设目标在某一帧只会出现在一个位置，首先在当前帧画面规定若干个Scanning-window grid（扫描窗），这些扫描窗的大小是根据程序初始化时给定的bounding-box按照一定比例缩放得到的。之后检测器会对每一个扫描窗进行分类，最终得到标记为“前景”的扫描窗。

- ###**学习模块[2]**

####&nbsp;&nbsp;&nbsp;&nbsp;这里的学习模块主要用到一种“PN学习”(PN learning)的方法。PN学习即PN learning, P指代Positive Constraint,也称之为P-expert或者growing event,N指代Negative Constraint,也称之为N-expert或者pruning event。

####&nbsp;&nbsp;&nbsp;&nbsp;P-expert的作用是发现目标的新的外观(形变)，并以此来增加正样本的数量，从而使得检测模块更具鲁棒性；N-expert的作用是生成负的训练样本。N-expert的前提假设是，(被跟踪的)前景目标仅可能出现在视频帧中的一个位置，因此，如果前景目标的位置是确定的，那么其周围必然是负样例。

####&nbsp;&nbsp;&nbsp;&nbsp;TLD模块中的PN学习作用是通过对视频序列的在线处理来逐步改善检测模块(TLD中的Detection)的性能。对视频中的每一帧而言，我们希望评估检测模块在当前帧中的误检，并以此来更新目标模型，从而使得在以后的视频帧处理过程中避免类似的错误再次发生。PN学习的关键在于两种类型的“专家(experts)”：P-experts检查那些被检测模块错误分类为正样本(前景目标)的数据；N-experts检查哪些被检测模块错误分类为负样本(背景)的数据；需要提醒的是，无论P-experts还是N-experts都会产生一定的偏差。那么，如果用这些存在偏差的数据来更新检测模块(目标模型)，是否会造成检测模型的性能恶化呢？作者经过研究发现，尽管存在误差，在一定条件下，误差是允许的，并且检测模块的性能会因此得到改善。

####&nbsp;&nbsp;&nbsp;&nbsp;PN学习包含四个部分：(1)一个待学习的分类器；(2)训练样本集--一些已知类别标签的样本；(3)监督学习--一种从训练样本集中训练分类器的方法；(4)P-N experts--在学习过程中用于产生正(训练)样本和负(训练)样本的表达函数；这四个部分之间的关系如下图所示：



#### **Reference**

[1] Zdenek Kalal, **Tracking learning detection**, TPAMI 2010.

[2] <http://blog.csdn.net/carson2005/article/details/7647519>