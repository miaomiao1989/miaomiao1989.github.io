---
layout: default
---
# **引导滤波**

#### 一般情况下，线性滤波模糊一张图像的过程为：给定一张引导图$$I$$, 输入图像$$p$$和输出图像$$q$$, 则输出图像中的每个像素点$$i$$可以表示为加权平均：

$$q_{i} = \underset{i}{\sum} W_{ij}(I)p_{j}$$

#### 其中$$j$$为同一局部窗口内的相邻像素。$$W_{ij}$$为滤波核。 文献[1]中定义的引导滤波最主要的假设是引导图$$I$$和输出图像$$q$$在局部窗口内存在线性关系。假设在以像素$$i$$为中心的局部窗口$$w_{k}$$内，输出图像和引导图之间的线性关系为：

$$q_{i} = a_{k}I_{i}+b_{k}, i \in w_{K}$$

#### 其中$$(a_{k}, b_{k})$$为局部窗口$$w_{k}$$内的线性系数。则问题的关键成为了求解这些线性系数。

#### 为了求解线性系数，我们需要对输入图像$$p$$进行约束。 我们可以认为滤波之后的输入图像为原始的图像减去噪声之后得到的，即：

$$q_{i} = p_{i} - n_{i}$$

#### 我们求解系数使得噪声最小化，可以通过在局部窗口$$w_{k}$$内求解如下代价方程：

$$E(a_{k}, b_{k}) = \underset{i\in w_{k}}{\sum}((a_{k}I_{i}+b_{k}-p_{i})^2) + \epsilon a_{k}^{2}$$

#### 其中$$\epsilon$$为正则化参数，这一最优化问题为线性脊回归问题，可以求得解为：

<div style="text-align: center">
<img src="../images/guid1.jpg">
</div>

#### 其中$$\mu_{k}, \sigma_{k}^{2}$$分别为引导图$$I$$在局部窗口$$w_{k}$$的均值和方差，$$\|w\|$$为局部窗口$$w_{k}$$内的像素个数， $$\overline(p_{k})=\frac{1}{\|w\|\sum_{i\in w_{k}}}$$为局部窗口$$w_{k}$$内的$$p$$的均值。

#### 如果计算得到了线性系数$$(a_{k}, b_{k})$$，既可以计算滤波输出图像$$q$$。

#### 这种保留线性关系不变在很大程度上保留了边缘。算法的实现如下

<div style="text-align: center">
<img src="../images/guid2.jpg">
</div>


#### **Refrence**

#### [1] Guided image filtering, PAMI, 2013.
