---
layout: default
---
#**特征描述算子**

####&nbsp;&nbsp;&nbsp;&nbsp;局部特征描述算子可以分为两类： 一类是基于“绝对”值的，另一类是基于比较的。基于绝对值的指注入sift，surf，gloh之类的描述子，一般的思路是将灰度，梯度等量化，构造直方图。这类描述子的判别性高，直观，但是有个通病就是计算复杂度高。基于比较的指诸如Ferns，BRIEF,Orb，OSID, BRISK之类的描述子。一般的思路是通过比较余弦训练的，或者随机点对的特征值的大小，来构造描述子。这类描述子一般都是为了提高计算速度而设计的。这列描述子不关心原始特征的绝对大小，值关心原始特征的ranking。

###**FAST特征点检测[1]**

####在局部特征点检测快速发展的时候，人们对于特征的认识也越来越深入，近几年来许多学者提出了许许多多的特征检测算法及其改进算法，在众多的特征提取算法中，不乏涌现出佼佼者。从最早期的Moravec，到Harris，再到SIFT、SUSAN、GLOH、SURF算法，可以说特征提取算法层出不穷。各种改进算法PCA-SIFT、ICA-SIFT、P-ASURF、R-ASURF、Radon-SIFT等也是搞得如火如荼，不亦乐乎。上面的算法如SIFT、SURF提取到的特征也是非常优秀（有较强的不变性），但是时间消耗依然很大，而在一个系统中，特征提取仅仅是一部分，还要进行诸如配准、提纯、融合等后续算法。这使得实时性不好，降系了统性能。

####Edward Rosten和Tom Drummond两位大神经过研究，于2006年在《Machine learning for high-speed corner detection》中提出了一种FAST特征点，并在2010年稍作修改后发表了《Features From Accelerated Segment Test》，简称FAST。<font color="blue">注意：FAST只是一种特征点检测算法，并不涉及特征点的特征描述。</font>

####**定义**

####FAST的提出者Rosten等将FAST角点定义为：若某像素与其周围邻域内足够多的像素点相差较大，则该像素可能是角点。

####**步骤**
<div style="text-align: center; height:400px">
<img src="../images/feat13.jpg">
</div>

1. 上图所示，一个以像素p为中心，半径为3的圆上，有16个像素点（p1、p2、...、p16）。
2. 定义一个阈值。计算p1、p9与中心p的像素差，若它们绝对值都小于阈值，则p点不可能是特征点，直接pass掉；否则，当做候选点，有待进一步考察；
3. 若p是候选点，则计算p1、p9、p5、p13与中心p的像素差，若它们的绝对值有至少3个超过阈值，则当做候选点，再进行下一步考察；否则，直接pass掉；
4. 若p是候选点，则计算p1到p16这16个点与中心p的像素差，若它们有至少9个超过阈值，则是特征点；否则，直接pass掉。
5. 对图像进行非极大值抑制：计算特征点出的FAST得分值（即score值，也即s值），判断以特征点p为中心的一个邻域（如3x3或5x5）内，计算若有多个特征点，则判断每个特征点的s值（16个点与中心差值的绝对值总和），若p是邻域所有特征点中响应值最大的，则保留；否则，抑制。若邻域内只有一个特征点（角点），则保留。得分计算公式如下（公式中用V表示得分，t表示阈值）：

<div style="text-align: center; height:100px">
<img src="../images/feat14.jpg">
</div>

####上面是FAST-9，当然FAST-10、FAST-11、FAST-12也是一样的，只是步骤4中，超过阈值的个数不一样。FAST算法实现起来简单，尤其是以速度快著称。

###**FREAK特征描述[2]**

####&nbsp;&nbsp;&nbsp;&nbsp;FREAK算法是在2012年CVPR上《FREAK: Fast Retina Keypoint》文章中提出了的一种特征提取算法，也是一种二进制的特征描述算子。它与BRISK算法非常相似，依然具有尺度不变性、旋转不变性和对噪声的鲁棒性等。

####**采样模式**

####&nbsp;&nbsp;&nbsp;&nbsp;在BRISK算法中，采样模式是均匀采样模式(在同一圆上等间隔进行采样)。FREAK算法中，采样模式发生了改变，它采取了更为接近于人眼视网膜接收图像信息的采样模型。图中展示了人眼视网膜拓扑结构，Fovea区域主要是对高进度的图像信息进行处理，Para主要是对低精度的图像信息进行处理。采样点为：6、6、6、6、6、6、6、1，那个1是特征点。

<div style="text-align: center">
<img src="../images/feat1.jpg">
</div>

####&nbsp;&nbsp;&nbsp;&nbsp;从图中可以看出，该结构是由很多大小不同并有重叠的圆构成，最中心的点是特征点，其它圆心是采样点，采样点离特征点的距离越远，采样点圆的半径越大，也表示该圆内的高斯函数半径越大

####**特征描述**

####&nbsp;&nbsp;&nbsp;&nbsp;F表示二进制描述子，Pa是采样点对（与BRISK同理），N表示期望的二进制编码长度。

<div style="text-align: center">
<img src="../images/feat2.jpg">
</div>

####$$I(P_{a}^{r_{1}}$$表示采样点对Pa中前一个采样点的像素值，同理，$$I(P_{a}^{r_{2}}$$表示后一个采样点的像素值。

####&nbsp;&nbsp;&nbsp;&nbsp;当然得到特征点的二进制描述符后，也就算完成了特征提取。但是FREAK还提出，将得到的Nbit二进制描述子进行筛选，希望得到更好的，更具有辨识度的描述子，也就是说要从中去粗取精。
1. <h4>建立矩阵D，D的每一行是一个FREAK二进制描述符，即每一行有N个元素；在上图的采样模式中公有43个采样点，可以产生43*(43-1)/2=903个采样点对，也就是说矩阵D有903行；
2. 对矩阵D的每一列计算其均值，由于D中元素都是0/1分布的，均值在0.5附近说明该列具有高的方差；
3. 每一列都有一个均值，以均值最接近0.5的排在第一位，均值离0.5越远的排在越靠后，对列进行排序；
4. 选取前512列作为最终的二进制描述符。</h4>

####&nbsp;&nbsp;&nbsp;&nbsp;由于FREAK描述符自身的圆形对称采样结构使其具有旋转不变性，采样的位置好半径随着尺度的变化使其具有尺度不变性，对每个采样点进行高斯模糊，也具有一定的抗噪性能，像素点的强度对比生成二进制描述子使其具有光照不变性。因此由上述产生的二进制描述子可以用来进行特征匹配。在匹配之前，再补充一下特征点的方向信息。

####**特征方向**
&nbsp;&nbsp;&nbsp;&nbsp;由于特征点周围有43个采样点，可产生43*(43-1)/2=903个采样点对，FREAK算法选取其中45个长的、对称的采样点对来提取特征点的方向，采样点对如下：

<div style="text-align: center">
<img src="../images/feat3.jpg">
</div>

####用O表示局部梯度信息，M表示采样点对个数，G表示采样点对集合，Po表示采样点对的位置，则：

<div style="text-align: center">
<img src="../images/feat4.jpg">
</div>

####同BRISK算法，可得到特征点的方向。

####**特征匹配**

####&nbsp;&nbsp;&nbsp;&nbsp;在特征描述中，我们得到了512bit的二进制描述符，该描述符的列是高方差——>低方差的排列，而高方差表征了模糊信息，低方差表征了细节信息，与人眼视网膜相似，人眼先处理的是模糊信息，再处理细节信息。因此，选取前128bit即16bytes进行匹配（异或），若两个待匹配的特征点前16bytes距离小于设定的阈值，则再用剩余的位信息进行匹配。这种方法可以剔除掉90%的不相关匹配点。注意：这里的16bytes的选取是建立在并行处理技术（SIMD）上的，并行处理技术处理16bytes与处理1bytes的时间相同；也就是说，16bytes并不是固定的，如果你的并行处理技术能处理32bytes与处理1bytes的时间相同的话，那么你也可以选取前32bytes。


###**BRISK特征描述[3]**

####&nbsp;&nbsp;&nbsp;&nbsp;BRISK算法是2011年ICCV上《BRISK:Binary Robust Invariant Scalable Keypoints》文章中，提出来的一种特征提取算法，也是一种二进制的特征描述算子。它具有较好的旋转不变性、尺度不变性，较好的鲁棒性等。在图像配准应用中，速度比较：SIFT<SURF<BRISK<FREAK<ORB，在对有较大模糊的图像配准时，BRISK算法在其中表现最为出色。

####**特征点检测**

####&nbsp;&nbsp;&nbsp;&nbsp;BRISK算法主要利用FAST9-16进行特征点检测（为什么是主要？因为用到一次FAST5-8），要解决尺度不变性，就必须在尺度空间进行特征点检测，于是BRISK算法中构造了图像金字塔进行多尺度表达。

#####**建立尺度空间**

####&nbsp;&nbsp;&nbsp;&nbsp;构造n个octave层（用ci表示）和n个intra-octave层（用di表示），文章中n=4，i={0,1,...,n-1}。假设有图像img，octave层的产生：c0层就是img原图像，c1层是c0层的2倍下采样，c2层是c1层的2倍下采样，以此类推。intra-octave层的产生：d0层是img的1.5倍下采样，d1层是d0层的2倍下采样（即img的2*1.5倍下采样），d2层是d1层的2倍下采样，以此类推。则ci、di层与原图像的尺度关系用t表示为：$$t(c_{i})=2^i, t(d_{i})=2^i*1.5$$，ci、di层与原图像大小关系为：

<div style="text-align: center">
<img src="../images/feat5.jpg">
</div>

####由于n=4，所以一共可以得到8张图，octave层之间尺度（缩放因子）是2倍关系，intra-octave层之间尺度（缩放因子）也是2倍关系。

#####**特征点检测**

####&nbsp;&nbsp;&nbsp;&nbsp;对这8张图进行FAST9-16角点检测，得到具有角点信息的8张图，对原图像img进行一次FAST5-8角点检测（当做d(-1)层，虚拟层），总共会得到9幅有角点信息的图像。

#####**非极大值抑制**

####&nbsp;&nbsp;&nbsp;&nbsp;对这9幅图像，进行空间上的非极大值抑制（同SIFT算法的非极大值抑制）：特征点在位置空间（8邻域点）和尺度空间（上下层2x9个点），共26个邻域点的FAST的得分值要最大，否则不能当做特征点；此时得到的极值点还比较粗糙，需要进一步精确定位。

#####**亚像素插值**

####&nbsp;&nbsp;&nbsp;&nbsp;进过上面步骤，得到了图像特征点的位置和尺度，在极值点所在层及其上下层所对应的位置，对FAST得分值（共3个）进行二维二次函数插值（x、y方向），得到真正意义上的得分极值点及其精确的坐标位置（作为特征点位置）；再对尺度方向进行一维插值，得到极值点所对应的尺度（作为特征点尺度）。

<div style="text-align: center">
<img src="../images/feat6.jpg">
</div>

####**特征点描述**

#####**高斯滤波**

####&nbsp;&nbsp;&nbsp;&nbsp;现在，我们得到了特征点的位置和尺度（t）后，要对特征点赋予其描述符。均匀采样模式：以特征点为中心，构建不同半径的同心圆，在每个圆上获取一定数目的等间隔采样点（所有采样点包括特征点，一共N个），由于这种邻域采样模式会引起混叠效应，所以需要对同心圆上的采样点进行高斯滤波。

#### &nbsp;&nbsp;&nbsp;&nbsp;采样模式如下图，蓝圈表示；以采样点为中心，为方差进行高斯滤波，滤波半径大小与高斯方差的大小成正比，红圈表示。最终用到的N个采样点是经过高斯平滑后的采样点。下图是t=1时的。（文章中：N=60）

<div style="text-align: center">
<img src="../images/feat7.jpg">
</div>

#####**局部梯度计算**

####&nbsp;&nbsp;&nbsp;&nbsp;由于有N个采样点，则采样点两两组合成一对，共有N(N-1)/2钟组合方式，所有组合方式的集合称作采样点对，用集合

<div style="text-align: center">
<img src="../images/feat8.jpg">
</div>

####表示，其中像素分别为$$I(p_{j}, \sigma_{j}),I(p_{j}, \sigma_{j})$$, $$\delta$$表示尺度。$$g(p_{i}, p_{j})$$表示特征点局部梯度集合，则有：

<div style="text-align: center">
<img src="../images/feat9.jpg">
</div>

####定义短距离点对子集、长距离点对子集（L个）：
<div style="text-align: center">
<img src="../images/feat10.jpg">
</div>

####其中， $$\delta_{max} = 9.75t, \delta_{min}= 13.67t$$, t是特征点所在的尺度.

####现在要利用上面得到的信息，来计算特征点的主方向（注意：此处只用到了长距离子集），如下：
<div style="text-align: center">
<img src="../images/feat11.jpg">
</div>

#####**特征描述符**

####&nbsp;&nbsp;&nbsp;&nbsp;要解决旋转不变性，则需要对特征点周围的采样区域进行旋转到主方向，旋转后得到新的采样区域，采样模式同上。BRISK描述子是二进制的特征，由采样点集合可得到N(N-1)/2对采样点对，就可以得到N(N-1)/2个距离的集合（包含长、短距离子集），考虑其中短距离子集中的512个短距离点对，进行二进制编码，判断方式如下：

<div style="text-align: center">
<img src="../images/feat12.jpg">
</div>

####其中，$$I(p_{j}^{\alpha}, \delta_{j})$$带有上标，表示经过旋转a角度后的，新的采样点。由此可得到，512Bit的二进制编码，也就是64个字节（BRISK64）。

#####**匹配方法**

####&nbsp;&nbsp;&nbsp;&nbsp;汉明距离进行比较，与其他二进制描述子的匹配方式一样。


###**Reference**

[1] http://blog.csdn.net/hujingshuang/article/details/46898007

[2] http://www.tqcto.com/article/code/1431.html

[3] http://blog.csdn.net/hujingshuang/article/details/47045497